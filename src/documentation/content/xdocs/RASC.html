<html>
    <head>
        <title>Apache Qpid : RASC</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Apache Qpid : RASC
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Apr 12, 2008 by <font color="#0050B2">cctrieloff</font>.
				    </div>

				    <h2><a name="RASC-RunningtheC%5CBroker"></a>Running the C+&#43; Broker</h2>

<p>It is really simple, to run cmd line</p>
<div class="code"><div class="codeContent">
<pre class="code-java">./qpidd</pre>
</div></div>
<p>to run as a daemon process</p>
<div class="code"><div class="codeContent">
<pre class="code-java">./qpidd --daemon</pre>
</div></div>
<p>stopping the daemon</p>
<div class="code"><div class="codeContent">
<pre class="code-java">./qpidd --quit</pre>
</div></div>

<h2><a name="RASC-Mostcommonquestionsgettingqpiddrunning"></a>Most common questions getting qpidd running</h2>

<p> <b>No data directory</b></p>

<p>The qpidd broker requires you to setup a data directory or specify &#45;-no-data-dir (see help for more details). Best<br/>
is to make sure that you have create a data directory for qpidd that the process has permissions to write to.</p>

<p>The default location is</p>
<div class="code"><div class="codeContent">
<pre class="code-java">/lib/<span class="code-keyword">var</span>/qpidd</pre>
</div></div>

<p>An alternate location can be set with &#45;-data-dir</p>

<p> <b>Starting qpidd and it says the that process is already locked</b></p>

<p>Note that when qpidd starts it creates a lock file is data directory are being used. If you have a un-controlled exit, please mail<br/>
the trace from the core to the qpid-dev@i.a.o mailing list. To clear the lock run</p>

<div class="code"><div class="codeContent">
<pre class="code-java">./qpidd -q</pre>
</div></div>

<p>It should also be noted that multiple brokers can be run on the same host. To do so set alternate data directories for each qpidd instance.</p>

<p> <b>Using the conf file</b></p>

<p>In order to use the conf file, use the same options that are on the command line</p>
<div class="code"><div class="codeContent">
<pre class="code-java">./qpidd --help</pre>
</div></div>

<p>but formated in the following way. <br/>
 a.) remove the '--' from the beginning of the option. <br/>
 b.) place a '=' between the option and the value. <br/>
 c.) place one option per line.</p>

<p> <b>Can I use any Language client with the C++ Broker</b></p>

<p>Yes, all the clients work with the C++ broker. The only restriction is that the client that matches the AMQP version needed to be used. When running the C++ broker, it is highly recommended to run AMQP 0-10.</p>

<p>Note that JMS also works with the C++ broker. For more details on using the Java client refer to these pages:</p>
<ul>
	<li><a href="How to Use JNDI.html" title="How to Use JNDI">How to Use JNDI</a></li>
	<li><a href="URL Formats.html" title="URL Formats">URL Formats for Qpid</a></li>
	<li><a href="Example Classes.html" title="Example Classes">Example Classes</a></li>
</ul>


<h2><a name="RASC-Slightlymorecomplexconfiguration"></a>Slightly more complex configuration</h2>

<p>The easiest way to get a full listing of the broker's options are to use the --help command, run it locally for the latest set of options. These options can then be set in the conf file for convenience (see above)</p>

<div class="code"><div class="codeContent">
<pre class="code-java">./qpidd --help

Usage: qpidd OPTIONS
Options:
  -h [ --help ]                    Displays the help message
  -v [ --version ]                 Displays version information
  --config FILE (/etc/qpidd.conf)  Reads configuration from FILE

Module options:
  --module-dir DIR (/usr/lib/qpidd)  Load all .so modules in <span class="code-keyword">this</span> directory
  --load-module FILE                 Specifies additional module(s) to be loaded
  --no-module-dir                    Don't load modules from module directory

Broker Options:
  --data-dir DIR (/<span class="code-keyword">var</span>/lib/qpidd)   Directory to contain persistent data generated by the broker
  --no-data-dir                     Don't use a data directory.  No persistent
                                    configuration will be loaded or stored
  -p [ --port ] PORT (5672)         Tells the broker to listen on PORT
  --worker-threads N (3)            Sets the broker thread pool size
  --max-connections N (500)         Sets the maximum allowed connections
  --connection-backlog N (10)       Sets the connection backlog limit <span class="code-keyword">for</span> the
                                    server socket
  --staging-threshold N (5000000)   Stages messages over N bytes to disk
  -m [ --mgmt-enable ] yes|no (1)   Enable Management
  --mgmt-pub-interval SECONDS (10)  Management Publish Interval
  --ack N (0)                       Send session.ack/solicit-ack at least every
                                    N frames. 0 disables voluntary ack/solitict
                                   -ack

Daemon options:
  -d [ --daemon ]             Run as a daemon.
  -w [ --wait ] SECONDS (10)  Sets the maximum wait time to initialize the
                              daemon. If the daemon fails to initialize, prints
                              an error and returns 1
  -c [ --check ]              Prints the daemon's process ID to stdout and
                              returns 0 <span class="code-keyword">if</span> the daemon is running, otherwise
                              returns 1
  -q [ --quit ]               Tells the daemon to shut down
Logging options:
  --log-output FILE (stderr)  Send log output to FILE. FILE can be a file name
                              or one of the special values:
                              stderr, stdout, syslog
  -t [ --trace ]              Enables all logging
  --log-enable RULE (error+)  Enables logging <span class="code-keyword">for</span> selected levels and component
                              s. RULE is in the form 'LEVEL+:PATTERN'
                              Levels are one of:
                              trace debug info notice warning error critical
                              For example:
                              '--log-enable warning+' logs all warning, error
                              and critical messages.
                              '--log-enable debug:framing' logs debug messages
                              from the framing namespace. This option can be
                              used multiple times
  --log-time yes|no (1)       Include time in log messages
  --log-level yes|no (1)      Include severity level in log messages
  --log-source yes|no (0)     Include source file:line in log messages
  --log-thread yes|no (0)     Include thread ID in log messages
  --log-function yes|no (0)   Include function signature in log messages</pre>
</div></div>

<h2><a name="RASC-Loadingextramodules"></a>Loading extra modules</h2>

<p>By default the broker will load all the modules in the module directory, however it will NOT display options for modules that are not loaded. So to see the options for extra modules loaded you need to load the module and then add the help command like this:</p>
<div class="code"><div class="codeContent">
<pre class="code-java">./qpidd --load-module libbdbstore.so --help
Usage: qpidd OPTIONS
Options:
  -h [ --help ]                    Displays the help message
  -v [ --version ]                 Displays version information
  --config FILE (/etc/qpidd.conf)  Reads configuration from FILE


 / .... non module options would be here ... /


Store Options:
  --store-directory DIR     Store directory location <span class="code-keyword">for</span> persistence (overrides
                            --data-dir)
  --store-async yes|no (1)  Use async persistence storage - <span class="code-keyword">if</span> store supports
                            it, enables AIO O_DIRECT.
  --store-force yes|no (0)  Force changing modes of store, will delete all
                            existing data <span class="code-keyword">if</span> mode is changed. Be SURE you want
                            to <span class="code-keyword">do</span> <span class="code-keyword">this</span>!
  --num-jfiles N (8)        <span class="code-object">Number</span> of files in persistence journal
  --jfile-size-pgs N (24)   Size of each journal file in multiples of read
                            pages (1 read page = 64kiB)</pre>
</div></div>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="border/border_bottom.gif"><img src="border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Apr 22, 2008 02:47</font></td>
		    </tr>
	    </table>
    </body>
</html>